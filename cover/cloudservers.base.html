<html>
<head>
<title>cloudservers.base</title>
</head>
<body>
cloudservers.base
<style>
.coverage pre {float: left; margin: 0px 1em; border: none;
               padding: 0px; }
.num pre { margin: 0px }
.nocov, .nocov pre {background-color: #faa}
.cov, .cov pre {background-color: #cfc}
div.coverage div { clear: both; height: 1.1em}
</style>
<div class="stats">
Covered: 45 lines<br/>
Missed: 2 lines<br/>
Skipped 10 lines<br/>
Percent: 95 %<br/>

</div>
<div class="coverage">
<div class="cov"><span class="num"><pre> 1</pre></span><pre>&quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre> 2</pre></span><pre>Base utilities to build API operation managers and objects on top of.</pre></div>
<div class="cov"><span class="num"><pre> 3</pre></span><pre>&quot;&quot;&quot;</pre></div>
<div class="skip"><span class="num"><pre> 4</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre> 5</pre></span><pre>class Manager(object):</pre></div>
<div class="cov"><span class="num"><pre> 6</pre></span><pre>    &quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre> 7</pre></span><pre>    Managers interact with a particular type of API (servers, flavors, images,</pre></div>
<div class="cov"><span class="num"><pre> 8</pre></span><pre>    etc.) and provide CRUD operations for them.</pre></div>
<div class="cov"><span class="num"><pre> 9</pre></span><pre>    &quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>10</pre></span><pre>    resource_class = None</pre></div>
<div class="skip"><span class="num"><pre>11</pre></span><pre>    </pre></div>
<div class="cov"><span class="num"><pre>12</pre></span><pre>    def __init__(self, client):</pre></div>
<div class="cov"><span class="num"><pre>13</pre></span><pre>        self.client = client</pre></div>
<div class="skip"><span class="num"><pre>14</pre></span><pre>        </pre></div>
<div class="cov"><span class="num"><pre>15</pre></span><pre>    def _list(self, url, response_key):</pre></div>
<div class="cov"><span class="num"><pre>16</pre></span><pre>        resp, body = self.client.get(url)</pre></div>
<div class="cov"><span class="num"><pre>17</pre></span><pre>        return [self.resource_class(self, res) for res in body[response_key]]</pre></div>
<div class="skip"><span class="num"><pre>18</pre></span><pre>    </pre></div>
<div class="cov"><span class="num"><pre>19</pre></span><pre>    def _get(self, url, response_key):</pre></div>
<div class="cov"><span class="num"><pre>20</pre></span><pre>        resp, body = self.client.get(url)</pre></div>
<div class="cov"><span class="num"><pre>21</pre></span><pre>        return self.resource_class(self, body[response_key])</pre></div>
<div class="skip"><span class="num"><pre>22</pre></span><pre>    </pre></div>
<div class="cov"><span class="num"><pre>23</pre></span><pre>    def _create(self, url, data, response_key):</pre></div>
<div class="cov"><span class="num"><pre>24</pre></span><pre>        resp, body = self.client.post(url, data=data)</pre></div>
<div class="cov"><span class="num"><pre>25</pre></span><pre>        return self.resource_class(self, body[response_key])</pre></div>
<div class="skip"><span class="num"><pre>26</pre></span><pre>        </pre></div>
<div class="cov"><span class="num"><pre>27</pre></span><pre>    def _delete(self, url):</pre></div>
<div class="cov"><span class="num"><pre>28</pre></span><pre>        resp, body = self.client.delete(url)</pre></div>
<div class="skip"><span class="num"><pre>29</pre></span><pre>    </pre></div>
<div class="cov"><span class="num"><pre>30</pre></span><pre>    def _update(self, url, data, response_key):</pre></div>
<div class="nocov"><span class="num"><pre>31</pre></span><pre>        resp, body = self.client.put(url, data=data)</pre></div>
<div class="nocov"><span class="num"><pre>32</pre></span><pre>        return self.resource_class(self, body[response_key])</pre></div>
<div class="skip"><span class="num"><pre>33</pre></span><pre>    </pre></div>
<div class="cov"><span class="num"><pre>34</pre></span><pre>class Resource(object):</pre></div>
<div class="cov"><span class="num"><pre>35</pre></span><pre>    &quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>36</pre></span><pre>    A resource represents a particular instance of an object (server, flavor,</pre></div>
<div class="cov"><span class="num"><pre>37</pre></span><pre>    etc). This is pretty much just a bag for attributes.</pre></div>
<div class="cov"><span class="num"><pre>38</pre></span><pre>    &quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>39</pre></span><pre>    def __init__(self, manager, info):</pre></div>
<div class="cov"><span class="num"><pre>40</pre></span><pre>        self.manager = manager</pre></div>
<div class="cov"><span class="num"><pre>41</pre></span><pre>        for (k, v) in info.iteritems():</pre></div>
<div class="cov"><span class="num"><pre>42</pre></span><pre>            setattr(self, k, v)</pre></div>
<div class="skip"><span class="num"><pre>43</pre></span><pre>            </pre></div>
<div class="cov"><span class="num"><pre>44</pre></span><pre>    def __repr__(self):</pre></div>
<div class="cov"><span class="num"><pre>45</pre></span><pre>        reprkeys = sorted(k for k in self.__dict__.keys() if k[0] != '_' and k != 'manager')</pre></div>
<div class="cov"><span class="num"><pre>46</pre></span><pre>        info = &quot;, &quot;.join(&quot;%s=%s&quot; % (k, getattr(self, k)) for k in reprkeys)</pre></div>
<div class="cov"><span class="num"><pre>47</pre></span><pre>        return &quot;&lt;%s %s&gt;&quot; % (self.__class__.__name__, info)</pre></div>
<div class="skip"><span class="num"><pre>48</pre></span><pre>        </pre></div>
<div class="cov"><span class="num"><pre>49</pre></span><pre>def getid(obj):</pre></div>
<div class="cov"><span class="num"><pre>50</pre></span><pre>    &quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>51</pre></span><pre>    Abstracts the common pattern of allowing both an object or an object's ID</pre></div>
<div class="cov"><span class="num"><pre>52</pre></span><pre>    (integer) as a parameter when dealing with relationships.</pre></div>
<div class="cov"><span class="num"><pre>53</pre></span><pre>    &quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>54</pre></span><pre>    try:</pre></div>
<div class="cov"><span class="num"><pre>55</pre></span><pre>        return obj.id</pre></div>
<div class="cov"><span class="num"><pre>56</pre></span><pre>    except AttributeError:</pre></div>
<div class="cov"><span class="num"><pre>57</pre></span><pre>        return int(obj)</pre></div>
</div>
</body>
</html>
